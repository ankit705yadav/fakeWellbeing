<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Fake Wellbeing</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
            rel="stylesheet"
        />
        <!-- Add in head -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <style>
            /* Custom styles to match the screenshot's aesthetic and create a mobile screen frame */
            body {
                font-family: "Inter", sans-serif;
                background-color: #1a1a1a; /* Dark background to frame the phone */
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 2rem;
                gap: 2rem;
            }
            .mobile-screen {
                /* === MODIFIED THIS RULE === */
                width: 100%; /* Use full available width */
                max-width: 420px; /* But don't exceed 420px */
                /* === END MODIFICATION === */
                height: 844px;
                background-color: #1c1b1f; /* The main background color from the screenshot */
                /*box-shadow:
                    0 10px 30px rgba(0, 0, 0, 0.5),
                    inset 0 0 2px rgba(255, 255, 255, 0.1);*/
                position: relative;
                overflow: hidden;
                display: flex;
                flex-direction: column;
                border: 8px solid #111;
                flex-shrink: 0; /* Prevent phone from shrinking */
            }
            .screen-content {
                padding: 1rem;
                padding-top: 3.5rem; /* Make space for the status bar */
                overflow-y: auto;
                flex-grow: 1;
                scrollbar-width: none; /* For Firefox */
            }
            /* Hide scrollbar for Chrome, Safari and Opera */
            .screen-content::-webkit-scrollbar {
                display: none;
            }

            #appDataInputs {
                scrollbar-width: none; /* For Firefox */
            }
            #appDataInputs::-webkit-scrollbar {
                display: none; /* For Chrome, Safari and Opera */
            }

            .status-bar {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 44px;
                padding: 0 28px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                color: #e8e4d8;
                font-size: 0.9rem;
                font-weight: 500;
            }
            .home-indicator {
                display: none;
                position: absolute;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
                width: 140px;
                height: 5px;
                background-color: #e8e4d8;
                border-radius: 100px;
                opacity: 0.8;
            }
            /* Updated custom colors from screenshot */
            .custom-card-bg {
                background-color: #2e2a21;
            }
            .custom-text-primary {
                color: #f5e1a4;
            }
            .custom-text-secondary {
                color: #c9c5b8;
            }
            .custom-border {
                border-color: #4d4a41;
            }

            /* Styles for new input controls */
            .control-input {
                background-color: #4d4a41;
                border: 1px solid #6a644f;
                color: #e8e4d8;
                border-radius: 0.5rem;
                padding: 0.5rem 0.75rem;
                width: 100%;
                font-size: 0.875rem;
            }
            .control-input:focus {
                outline: none;
                border-color: #f5e1a4;
                box-shadow: 0 0 0 2px rgba(245, 225, 164, 0.5);
            }
            .control-label {
                font-size: 0.875rem;
                font-weight: 500;
                margin-bottom: 0.5rem;
                display: block;
            }
            .control-btn {
                background-color: #f5e1a4;
                color: #2e2a21;
                border: none;
                border-radius: 9999px;
                padding: 0.6rem 1.25rem;
                font-weight: 600;
                cursor: pointer;
                transition: background-color 0.2s;
            }
            .control-btn:hover {
                background-color: #e8d394;
            }
            .remove-btn {
                background-color: #6a644f;
                color: #f5e1a4;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                font-weight: bold;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            /* === ADDED THIS SECTION FOR MOBILE RESPONSIVENESS === */
            @media (max-width: 920px) {
                body {
                    flex-direction: column-reverse; /* Stack elements vertically and reverse order */
                    align-items: center;
                    padding: 1rem;
                }
                .controls-container {
                    margin-top: 0; /* Remove the large top margin on mobile */
                }
            }
        </style>
    </head>
    <body class="bg-gray-800 flex justify-center items-start min-h-screen">
        <div
            class="custom-card-bg rounded-3xl p-5 w-full max-w-xs mt-16 controls-container"
        >
            <h2
                class="text-lg font-medium custom-text-primary mb-4 text-center"
            >
                Data Controls
            </h2>

            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label for="unlocksInput" class="control-label"
                        >Unlocks</label
                    >
                    <input
                        type="number"
                        id="unlocksInput"
                        class="control-input"
                        value="44"
                    />
                </div>
                <div>
                    <label for="notificationsInput" class="control-label"
                        >Notifications</label
                    >
                    <input
                        type="number"
                        id="notificationsInput"
                        class="control-input"
                        value="204"
                    />
                </div>
            </div>

            <h3 class="font-medium custom-text-primary mb-3">
                App Usage (minutes)
            </h3>
            <div id="appDataInputs" class="space-y-2 mb-4 pr-2"></div>

            <button
                id="addAppBtn"
                class="w-full py-2 border custom-border rounded-full text-sm text-center custom-text-primary hover:bg-white/5 transition-colors duration-300 mb-4"
            >
                + Add App
            </button>

            <button id="updateBtn" class="control-btn w-full">
                Update Stats
            </button>

            <button id="downloadBtn" class="control-btn w-full mt-3">
                Download Screenshot
            </button>
        </div>

        <div class="mobile-screen">
            <div class="status-bar"></div>

            <div class="screen-content">
                <div class="w-full max-w-sm mx-auto">
                    <header class="flex justify-between items-center mb-6">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="custom-text-primary"
                        >
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="custom-text-primary"
                        >
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="12" cy="5" r="1"></circle>
                            <circle cx="12" cy="19" r="1"></circle>
                        </svg>
                    </header>

                    <main>
                        <h1
                            class="text-3xl font-semibold custom-text-primary mb-6 mt-16"
                        >
                            Digital Wellbeing
                        </h1>

                        <div
                            class="custom-card-bg rounded-3xl p-6 flex flex-col items-center mb-6"
                        >
                            <div class="relative w-64 h-64 mb-6">
                                <canvas
                                    id="appUsageChart"
                                    width="256"
                                    height="256"
                                ></canvas>
                                <div
                                    id="screenTimeDisplay"
                                    class="absolute inset-0 flex flex-col items-center justify-center"
                                >
                                    <span class="text-sm custom-text-secondary"
                                        >Today</span
                                    >
                                    <span
                                        class="text-3xl font-bold custom-text-primary"
                                        >6h 38m</span
                                    >
                                </div>
                            </div>

                            <button
                                class="w-full py-3 border custom-border rounded-full text-center custom-text-primary hover:bg-white/5 transition-colors duration-300"
                            >
                                View app activity details
                            </button>
                        </div>

                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="custom-card-bg rounded-3xl p-5">
                                <p
                                    id="unlocksDisplay"
                                    class="text-4xl font-bold custom-text-primary"
                                >
                                    44
                                </p>
                                <p class="custom-text-secondary">Unlocks</p>
                            </div>
                            <div class="custom-card-bg rounded-3xl p-5">
                                <p
                                    id="notificationsDisplay"
                                    class="text-4xl font-bold custom-text-primary"
                                >
                                    204
                                </p>
                                <p class="custom-text-secondary">
                                    Notifications
                                </p>
                            </div>
                        </div>

                        <p class="text-xs custom-text-secondary px-2 mb-8">
                            This data is from your personal profile and doesn't
                            include other profile activities.
                        </p>

                        <div class="mb-8">
                            <h2
                                class="text-lg font-medium custom-text-primary mb-3"
                            >
                                Ways to disconnect
                            </h2>
                            <div class="custom-card-bg rounded-3xl p-5">
                                <p class="font-medium custom-text-primary">
                                    App timers
                                </p>
                                <p class="text-sm custom-text-secondary">
                                    2 timers set
                                </p>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <div class="home-indicator"></div>
        </div>

        <script>
            // Initial Data for the app usage chart
            const initialAppData = [
                { label: "Instagram", value: 100, color: "#facc15" }, // yellow-400
                { label: "Reddit", value: 80, color: "#a3e635" }, // lime-400
                { label: "YouTube", value: 72, color: "#4ade80" }, // green-400
                { label: "Drive", value: 60, color: "#6ee7b7" }, // emerald-300
                { label: "Threads", value: 40, color: "#a7f3d0" }, // emerald-200
                { label: "Photos", value: 28, color: "#d1fae5" }, // emerald-100
                { label: "Other", value: 20, color: "#fef3c7" }, // amber-100
            ];

            const colorPalette = [
                "#f87171",
                "#fb923c",
                "#34d399",
                "#60a5fa",
                "#818cf8",
                "#a78bfa",
                "#f472b6",
            ];
            let colorIndex = 0;

            const unlocksDisplay = document.getElementById("unlocksDisplay");
            const notificationsDisplay = document.getElementById(
                "notificationsDisplay",
            );
            const screenTimeDisplay = document
                .getElementById("screenTimeDisplay")
                .querySelector("span:last-child");

            const unlocksInput = document.getElementById("unlocksInput");
            const notificationsInput =
                document.getElementById("notificationsInput");
            const appDataInputsContainer =
                document.getElementById("appDataInputs");

            const addAppBtn = document.getElementById("addAppBtn");
            const updateBtn = document.getElementById("updateBtn");

            function addAppRow(app = { label: "", value: "", color: "" }) {
                const row = document.createElement("div");
                row.className = "flex items-center gap-2 app-input-row";

                const newColor =
                    app.color || colorPalette[colorIndex % colorPalette.length];
                if (!app.color) colorIndex++;
                row.dataset.color = newColor;

                row.innerHTML = `
                <input type="text" placeholder="App Name" class="control-input flex-grow" value="${app.label}">
                <input type="number" placeholder="min" class="control-input w-20" value="${app.value}">
                <button class="remove-btn">-</button>
            `;
                appDataInputsContainer.appendChild(row);
                row.querySelector(".remove-btn").addEventListener("click", () =>
                    row.remove(),
                );
            }

            function populateInitialInputs() {
                initialAppData.forEach((app) => addAppRow(app));
            }

            function updateStats() {
                // Update Unlocks and Notifications
                unlocksDisplay.textContent = unlocksInput.value || 0;
                notificationsDisplay.textContent =
                    notificationsInput.value || 0;

                // Collect app data and calculate total screen time
                const appData = [];
                let totalMinutes = 0;
                document.querySelectorAll(".app-input-row").forEach((row) => {
                    const label = row.querySelector('input[type="text"]').value;
                    const value = parseFloat(
                        row.querySelector('input[type="number"]').value,
                    );
                    if (label && value > 0) {
                        totalMinutes += value;
                        appData.push({
                            label,
                            value,
                            color: row.dataset.color,
                        });
                    }
                });

                const hours = Math.floor(totalMinutes / 60);
                const minutes = Math.round(totalMinutes % 60);

                // Update main display
                screenTimeDisplay.textContent = `${hours}h ${minutes}m`;

                // Re-draw chart
                drawChart(appData);
            }

            // Function to draw the donut chart
            function drawChart(appData) {
                const canvas = document.getElementById("appUsageChart");
                const chartContainer = canvas.parentElement;
                if (!canvas.getContext) return;

                // Clear previous labels
                chartContainer
                    .querySelectorAll(".dynamic-app-label")
                    .forEach((el) => el.remove());

                const ctx = canvas.getContext("2d");
                ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas

                const centerX = canvas.width / 2;
                const centerY = canvas.height / 2;
                const radius = 90;
                const lineWidth = 35;
                const gap = 0.05; // Gap between segments in radians

                const totalValue = appData.reduce(
                    (sum, item) => sum + item.value,
                    0,
                );
                if (totalValue === 0) return; // Don't draw if no data

                let currentAngle = -Math.PI / 2; // Start from the top

                appData.forEach((item) => {
                    const sliceAngle =
                        (item.value / totalValue) * (2 * Math.PI);
                    const startAngle = currentAngle + gap / 2;
                    const endAngle = currentAngle + sliceAngle - gap / 2;

                    // Draw the arc segment
                    ctx.beginPath();
                    ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                    ctx.lineWidth = lineWidth;
                    ctx.strokeStyle = item.color;
                    ctx.stroke();

                    // Position the label
                    const midAngle = currentAngle + sliceAngle / 2;
                    const labelRadius = radius + lineWidth;
                    const labelX = centerX + labelRadius * Math.cos(midAngle);
                    const labelY = centerY + labelRadius * Math.sin(midAngle);

                    // Create label element
                    const label = document.createElement("div");
                    label.textContent = item.label;
                    label.className =
                        "absolute text-xs custom-text-secondary dynamic-app-label";

                    if (labelX < centerX) {
                        label.style.textAlign = "right";
                        label.style.right = `${canvas.width - labelX}px`;
                    } else {
                        label.style.textAlign = "left";
                        label.style.left = `${labelX}px`;
                    }
                    label.style.top = `${labelY - 8}px`; // Center vertically
                    chartContainer.appendChild(label);

                    currentAngle += sliceAngle;
                });
            }

            // Setup event listeners and initial state
            window.onload = () => {
                // === ADDED THIS SNIPPET ===
                if (window.innerWidth <= 920) {
                    alert("For best experience use desktop mode");
                }
                // === END SNIPPET ===

                populateInitialInputs();
                updateStats(); // Initial draw
                addAppBtn.addEventListener("click", () => addAppRow());
                updateBtn.addEventListener("click", updateStats);
            };

            document
                .getElementById("downloadBtn")
                .addEventListener("click", () => {
                    const target = document.querySelector(".mobile-screen");
                    html2canvas(target, { backgroundColor: null }).then(
                        (canvas) => {
                            const link = document.createElement("a");
                            link.download = "mobile-screen.png";
                            link.href = canvas.toDataURL("image/png");
                            link.click();
                        },
                    );
                });
        </script>
    </body>
</html>
